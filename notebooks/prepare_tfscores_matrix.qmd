---
title: "Prepare files for predictDB training"
author: "Temi"
date: 'Wed Jul 12 2023'
format: 
  pdf: 
    toc: true
    number-sections: true
    code-line-numbers: true
---

```{r}
library(data.table)
library(tidyverse)
library(glue)
```

```{r}
valid_chr <- paste0('chr', c(1:22), sep='')
valid_chr
```


### Prepare to train on 1KG EUR individuals only

```{r}
mtinfo <- data.table::fread('/project2/haky/Data/1000G/samples_information.txt')
mtinfo[1:5, 1:8]
```

```{r}
base_dir <- '/project2/haky/temi/projects/TFXcan/experiments/compare_predictors/tfpred_scores'
```
```{r}
dt <- data.table::fread(file.path(base_dir, 'aggByCollect_AR_Prostate_1KG.linear.txt.gz'))
dim(dt) ; dt[1:5, 1:5]
```

```{r}
EUR_dt <- dt %>% 
    dplyr::select(any_of(c('locus', mtinfo$`Sample name`[mtinfo$`Superpopulation code` == 'EUR']))) %>% dplyr::rename(NAME=locus)

EUR_dt[1:5, 1:5] ; dim(EUR_dt)
```

```{r}
EUR_dt %>% 
    data.table::fwrite('/project2/haky/temi/projects/l-TFPred/data/geno_and_snps_annot/TFPred_scores_EUR.AR_Prostate.linear.txt', sep='\t', row.names=F, quote=F)
```


