<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Temi">
<meta name="dcterms.date" content="2023-06-01">

<title>Association analysis of AR-prostate TFPred scores with GEUVADIS gene expression</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="association_2_files/libs/clipboard/clipboard.min.js"></script>
<script src="association_2_files/libs/quarto-html/quarto.js"></script>
<script src="association_2_files/libs/quarto-html/popper.min.js"></script>
<script src="association_2_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="association_2_files/libs/quarto-html/anchor.min.js"></script>
<link href="association_2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="association_2_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="association_2_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="association_2_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="association_2_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Association analysis of AR-prostate TFPred scores with GEUVADIS gene expression</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Temi </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 1, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>expr_dir <span class="ot">&lt;-</span> <span class="st">'/lus/grand/projects/TFXcan/imlab/users/temi/projects/TFXcan/experiments'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"BiocManager"</span>, <span class="at">quietly=</span><span class="cn">TRUE</span>)){<span class="fu">install.packages</span>(<span class="st">"BiocManager"</span>)}</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">"annotatr"</span>)){BiocManager<span class="sc">::</span><span class="fu">install</span>(<span class="st">"annotatr"</span>)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: annotatr</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">"TxDb.Hsapiens.UCSC.hg38.knownGene"</span>)){BiocManager<span class="sc">::</span><span class="fu">install</span>(<span class="st">"TxDb.Hsapiens.UCSC.hg38.knownGene"</span>)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: TxDb.Hsapiens.UCSC.hg38.knownGene</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: GenomicFeatures</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: BiocGenerics</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'BiocGenerics'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    IQR, mad, sd, var, xtabs</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    anyDuplicated, aperm, append, as.data.frame, basename, cbind,
    colnames, dirname, do.call, duplicated, eval, evalq, Filter, Find,
    get, grep, grepl, intersect, is.unsorted, lapply, Map, mapply,
    match, mget, order, paste, pmax, pmax.int, pmin, pmin.int,
    Position, rank, rbind, Reduce, rownames, sapply, setdiff, sort,
    table, tapply, union, unique, unsplit, which.max, which.min</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: S4Vectors</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: stats4</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'S4Vectors'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    expand.grid, I, unname</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: IRanges</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: GenomeInfoDb</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: GenomicRanges</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: AnnotationDbi</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Biobase</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ensembldb)</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(EnsDb.Hsapiens.v86)</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">"EnsDb.Hsapiens.v86"</span>)){BiocManager<span class="sc">::</span><span class="fu">install</span>(<span class="st">"EnsDb.Hsapiens.v86"</span>)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: EnsDb.Hsapiens.v86</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ensembldb</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: AnnotationFilter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'ensembldb'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    filter</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glue)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'glue'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:GenomicRanges':

    trim</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:IRanges':

    trim</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GenomicRanges)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reticulate)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(R.utils)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: R.oo</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: R.methodsS3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>R.methodsS3 v1.8.2 (2022-06-13 22:00:14 UTC) successfully loaded. See ?R.methodsS3 for help.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>R.oo v1.25.0 (2022-06-12 02:20:02 UTC) successfully loaded. See ?R.oo for help.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'R.oo'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:R.methodsS3':

    throw</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:glue':

    trim</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:GenomicRanges':

    trim</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:IRanges':

    trim</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:methods':

    getClasses, getMethods</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    attach, detach, load, save</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>R.utils v2.12.2 (2022-11-11 22:00:03 UTC) successfully loaded. See ?R.utils for help.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'R.utils'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:utils':

    timestamp</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    cat, commandArgs, getOption, isOpen, nullfile, parse, warnings</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'data.table'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:GenomicRanges':

    shift</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:IRanges':

    shift</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:S4Vectors':

    first, second</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.2     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.2     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.1     </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ lubridate::%within%() masks IRanges::%within%()
✖ dplyr::between()      masks data.table::between()
✖ dplyr::collapse()     masks IRanges::collapse()
✖ dplyr::combine()      masks Biobase::combine(), BiocGenerics::combine()
✖ dplyr::desc()         masks IRanges::desc()
✖ tidyr::expand()       masks S4Vectors::expand()
✖ tidyr::extract()      masks R.utils::extract()
✖ dplyr::filter()       masks ensembldb::filter(), stats::filter()
✖ dplyr::first()        masks data.table::first(), S4Vectors::first()
✖ lubridate::hour()     masks data.table::hour()
✖ lubridate::isoweek()  masks data.table::isoweek()
✖ dplyr::lag()          masks stats::lag()
✖ dplyr::last()         masks data.table::last()
✖ lubridate::mday()     masks data.table::mday()
✖ lubridate::minute()   masks data.table::minute()
✖ lubridate::month()    masks data.table::month()
✖ ggplot2::Position()   masks BiocGenerics::Position(), base::Position()
✖ lubridate::quarter()  masks data.table::quarter()
✖ purrr::reduce()       masks GenomicRanges::reduce(), IRanges::reduce()
✖ dplyr::rename()       masks S4Vectors::rename()
✖ lubridate::second()   masks data.table::second(), S4Vectors::second()
✖ lubridate::second&lt;-() masks S4Vectors::second&lt;-()
✖ dplyr::select()       masks ensembldb::select(), AnnotationDbi::select()
✖ dplyr::slice()        masks IRanges::slice()
✖ purrr::transpose()    masks data.table::transpose()
✖ lubridate::wday()     masks data.table::wday()
✖ lubridate::week()     masks data.table::week()
✖ lubridate::yday()     masks data.table::yday()
✖ lubridate::year()     masks data.table::year()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(annotatr)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AnnotationHub)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: BiocFileCache
Loading required package: dbplyr

Attaching package: 'dbplyr'

The following objects are masked from 'package:dplyr':

    ident, sql


Attaching package: 'AnnotationHub'

The following object is masked from 'package:Biobase':

    cache</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(biomaRt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>valid_chr <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">22</span>, <span class="st">'X'</span>, <span class="st">'Y'</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>valid_chr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "1"  "2"  "3"  "4"  "5"  "6"  "7"  "8"  "9"  "10" "11" "12" "13" "14" "15"
[16] "16" "17" "18" "19" "20" "21" "22" "X"  "Y" </code></pre>
</div>
</div>
<section id="after-predictions" class="level3">
<h3 class="anchored" data-anchor-id="after-predictions">After predictions</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co">#setwd('/grand/TFXcan/imlab/users/temi/projects/TFXcan/scripts/')</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>project_dir <span class="ot">&lt;-</span> <span class="st">'/lus/grand/projects/TFXcan/imlab/users/temi/projects/TFXcan'</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">glue</span>(<span class="st">'{project_dir}/TFPred_pipeline/pipelines/utilities.R'</span>))</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>experiment_dir <span class="ot">&lt;-</span> <span class="st">'/lus/grand/projects/TFXcan/imlab/users/temi/projects/TFXcan/experiments/association'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>So there are about 4 different rds files ==&gt; I will process one for now, but join with the others later and modify this script</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># predictions</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="co"># tfpred_predictions &lt;- readRDS(glue('{experiment_dir}/output/aggByMean_AR_Prostate_geuvadis.linear.01.rds'))</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>tfpred_matrix <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map</span>(<span class="fu">c</span>(<span class="st">'01'</span>, <span class="st">'02'</span>, <span class="st">'03'</span>, <span class="st">'04'</span>), <span class="cf">function</span>(ii){</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  tfpred_predictions <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">glue</span>(<span class="st">'{experiment_dir}/output/aggByMean_AR_Prostate_geuvadis.linear.{ii}.rds'</span>))</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">lapply</span>(tfpred_predictions, <span class="cf">function</span>(each_ind){</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">setDT</span>(each_ind<span class="sc">$</span>aggByMean)</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>    a</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>  tfpred_matrix <span class="ot">&lt;-</span> out <span class="sc">%&gt;%</span> purrr<span class="sc">::</span><span class="fu">reduce</span>(dplyr<span class="sc">::</span>inner_join, <span class="at">by=</span><span class="st">'regions'</span>)</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(tfpred_matrix) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'regions'</span>, <span class="fu">names</span>(tfpred_predictions))</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(tfpred_matrix)</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>}) <span class="sc">%&gt;%</span> purrr<span class="sc">::</span><span class="fu">reduce</span>(dplyr<span class="sc">::</span>inner_join, <span class="at">by=</span><span class="fu">c</span>(<span class="st">'regions'</span>)) <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">'regions'</span>)</span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(tfpred_matrix) ; tfpred_matrix[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15024   448</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                           HG00262    HG00246    HG00187    HG00151    NA12872
chr6_107459565_107460564 0.3306418 0.33286358 0.32760535 0.32684507 0.33357008
chr6_3230807_3231806     0.2122660 0.21198024 0.21221499 0.21438659 0.21107506
chr6_44386706_44387705   0.0210355 0.02070309 0.01877992 0.01806819 0.01854296
chr6_36195744_36196743   0.2970409 0.29687855 0.29652629 0.29620033 0.29660880
chr6_138160939_138161938 0.1628000 0.17032602 0.16213668 0.16485335 0.16580068</code></pre>
</div>
</div>
<p>For completeness, go through all the loci in the predictions and select the intersections</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ty &lt;- function(a, b){</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   intersect(a[['aggByMean']][, 'regions'], b[['aggByMean']][, 'regions'])</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   # sum(length(a[['aggByMean']][, 'regions']), length(b[['aggByMean']][, 'regions']))</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>common_regions <span class="ot">&lt;-</span> <span class="fu">rownames</span>(tfpred_matrix) </span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>common_regions[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>] ; <span class="fu">length</span>(common_regions)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "chr6_107459565_107460564" "chr6_3230807_3231806"    
 [3] "chr6_44386706_44387705"   "chr6_36195744_36196743"  
 [5] "chr6_138160939_138161938" "chr6_106628578_106629577"
 [7] "chr6_111258327_111259326" "chr6_36972025_36973024"  
 [9] "chr6_73521576_73522575"   "chr3_123066025_123067024"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15024</code></pre>
</div>
</div>
</section>
<section id="need-to-associate-the-loci-back-to-the-promoters-and-back-to-the-genes" class="level3">
<h3 class="anchored" data-anchor-id="need-to-associate-the-loci-back-to-the-promoters-and-back-to-the-genes">Need to associate the loci back to the promoters and back to the genes</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>promoter_mtdt <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="fu">glue</span>(<span class="st">'{experiment_dir}/metadata/geuvadis_expression_promoters.txt'</span>))</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(promoter_mtdt); promoter_mtdt[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15577   475</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>        ensembl_id seqnames     start       end width strand              id
1: ENSG00000000003     chrX 100636807 100637806  1000      - promoter:248599
2: ENSG00000000419    chr20  50958551  50959550  1000      - promoter:233020
3: ENSG00000000457     chr1 169893897 169894896  1000      -  promoter:19656
4: ENSG00000000460     chr1 169661007 169662006  1000      +   promoter:8564
5: ENSG00000000938     chr1  27635186  27636185  1000      -  promoter:13472
                tx_id   symbol           TargetID
1:  ENST00000373020.9   TSPAN6  ENSG00000000003.9
2:  ENST00000466152.5     DPM1  ENSG00000000419.7
3: ENST00000367771.11    SCYL3  ENSG00000000457.8
4:  ENST00000498289.5 C1orf112 ENSG00000000460.11
5:  ENST00000374005.8      FGR  ENSG00000000938.7</code></pre>
</div>
</div>
<p>Filter for the predicted loci</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>subset_promoter_mtdt <span class="ot">&lt;-</span> promoter_mtdt <span class="sc">%&gt;%</span> tidyr<span class="sc">::</span><span class="fu">unite</span>(loci, seqnames<span class="sc">:</span>end, <span class="at">sep=</span><span class="st">'_'</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(loci <span class="sc">%in%</span> common_regions)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>subset_promoter_mtdt[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>] ; <span class="fu">dim</span>(subset_promoter_mtdt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       ensembl_id                     loci width strand              id
1 ENSG00000000419  chr20_50958551_50959550  1000      - promoter:233020
2 ENSG00000000457 chr1_169893897_169894896  1000      -  promoter:19656
3 ENSG00000000460 chr1_169661007_169662006  1000      +   promoter:8564
4 ENSG00000000938   chr1_27635186_27636185  1000      -  promoter:13472
5 ENSG00000001036 chr6_143511721_143512720  1000      -  promoter:90087
               tx_id   symbol           TargetID        Gene_Symbol Chr
1  ENST00000466152.5     DPM1  ENSG00000000419.7  ENSG00000000419.7  20
2 ENST00000367771.11    SCYL3  ENSG00000000457.8  ENSG00000000457.8   1
3  ENST00000498289.5 C1orf112 ENSG00000000460.11 ENSG00000000460.11   1
4  ENST00000374005.8      FGR  ENSG00000000938.7  ENSG00000000938.7   1
5 ENST00000002165.11    FUCA2  ENSG00000001036.8  ENSG00000001036.8   6</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15033   473</code></pre>
</div>
</div>
<p>There are some duplicated entries : because some promoter region may be associated with more than one gene For now, I will remove these but just doing <code>distinct</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>subset_promoter_mtdt <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">group_by</span>(loci) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;</span> <span class="dv">1</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 18 × 473
# Groups:   loci [9]
   ensembl_id   loci  width strand id    tx_id symbol TargetID Gene_Symbol Chr  
   &lt;chr&gt;        &lt;chr&gt; &lt;int&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;       &lt;chr&gt;
 1 ENSG0000005… chr1…  1000 +      prom… ENST… ZC3H1… ENSG000… ENSG000000… 1    
 2 ENSG0000014… chr2…  1000 -      prom… ENST… CALM2  ENSG000… ENSG000001… 2    
 3 ENSG0000015… chr5…  1000 +      prom… ENST… PELO   ENSG000… ENSG000001… 5    
 4 ENSG0000016… chr1…  1000 +      prom… ENST… ZNF761 ENSG000… ENSG000001… 19   
 5 ENSG0000016… chr1…  1000 -      prom… ENST… TPTE2… ENSG000… ENSG000001… 13   
 6 ENSG0000018… chr2…  1000 -      prom… ENST… UBOX5  ENSG000… ENSG000001… 20   
 7 ENSG0000020… chr1…  1000 +      prom… ENST… LINC0… ENSG000… ENSG000002… 12   
 8 ENSG0000021… chr1…  1000 -      prom… ENST… ZNF62… ENSG000… ENSG000002… 19   
 9 ENSG0000021… chr5…  1000 +      prom… ENST… ITGA1  ENSG000… ENSG000002… 5    
10 ENSG0000021… chr2…  1000 -      prom… ENST… FASTK… ENSG000… ENSG000002… 20   
11 ENSG0000023… chr1…  1000 +      prom… ENST… RBM14  ENSG000… ENSG000002… 11   
12 ENSG0000023… chr2…  1000 -      prom… ENST… STPG4  ENSG000… ENSG000002… 2    
13 ENSG0000023… chr1…  1000 -      prom… ENST… SUGT1… ENSG000… ENSG000002… 13   
14 ENSG0000024… chr1…  1000 +      prom… ENST… TPM3P9 ENSG000… ENSG000002… 19   
15 ENSG0000024… chr1…  1000 +      prom… ENST… RBM14… ENSG000… ENSG000002… 11   
16 ENSG0000025… chr1…  1000 +      prom… ENST… CLLU1  ENSG000… ENSG000002… 12   
17 ENSG0000025… chr1…  1000 +      prom… ENST… ZBED6  ENSG000… ENSG000002… 1    
18 ENSG0000025… chr1…  1000 -      prom… ENST… ZNF625 ENSG000… ENSG000002… 19   
# ℹ 463 more variables: Coord &lt;int&gt;, HG00096 &lt;dbl&gt;, HG00097 &lt;dbl&gt;,
#   HG00099 &lt;dbl&gt;, HG00100 &lt;dbl&gt;, HG00101 &lt;dbl&gt;, HG00102 &lt;dbl&gt;, HG00103 &lt;dbl&gt;,
#   HG00104 &lt;dbl&gt;, HG00105 &lt;dbl&gt;, HG00106 &lt;dbl&gt;, HG00108 &lt;dbl&gt;, HG00109 &lt;dbl&gt;,
#   HG00110 &lt;dbl&gt;, HG00111 &lt;dbl&gt;, HG00112 &lt;dbl&gt;, HG00114 &lt;dbl&gt;, HG00115 &lt;dbl&gt;,
#   HG00116 &lt;dbl&gt;, HG00117 &lt;dbl&gt;, HG00118 &lt;dbl&gt;, HG00119 &lt;dbl&gt;, HG00120 &lt;dbl&gt;,
#   HG00121 &lt;dbl&gt;, HG00122 &lt;dbl&gt;, HG00123 &lt;dbl&gt;, HG00124 &lt;dbl&gt;, HG00125 &lt;dbl&gt;,
#   HG00126 &lt;dbl&gt;, HG00127 &lt;dbl&gt;, HG00128 &lt;dbl&gt;, HG00129 &lt;dbl&gt;, …</code></pre>
</div>
</div>
<p>Select the individuals</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>geuvadis_individuals <span class="ot">&lt;-</span> <span class="fu">colnames</span>(tfpred_matrix)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(geuvadis_individuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 448</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>gene_expr <span class="ot">&lt;-</span> subset_promoter_mtdt <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">all_of</span>(<span class="fu">c</span>(<span class="st">'ensembl_id'</span>, <span class="st">'symbol'</span>, <span class="st">'loci'</span>, geuvadis_individuals))) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">distinct</span>(loci, <span class="at">.keep_all=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">match</span>(loci, common_regions))</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(gene_expr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15024   451</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># merge each loci </span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>mt <span class="ot">&lt;-</span> gene_expr <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">all_of</span>(<span class="fu">c</span>(<span class="st">'loci'</span>, <span class="st">'symbol'</span>)))</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>tfpred_matrix <span class="ot">&lt;-</span> tfpred_matrix <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">'loci'</span>) <span class="sc">%&gt;%</span> <span class="fu">inner_join</span>(mt, <span class="at">by=</span><span class="fu">c</span>(<span class="st">'loci'</span> <span class="ot">=</span> <span class="st">'loci'</span>)) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">relocate</span>(symbol)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>tfpred_matrix[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>] ; <span class="fu">dim</span>(tfpred_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   symbol                     loci   HG00262    HG00246    HG00187
1   PDSS2 chr6_107459565_107460564 0.3306418 0.33286358 0.32760535
2   PSMG4     chr6_3230807_3231806 0.2122660 0.21198024 0.21221499
3   CDC5L   chr6_44386706_44387705 0.0210355 0.02070309 0.01877992
4   BRPF3   chr6_36195744_36196743 0.2970409 0.29687855 0.29652629
5 ARFGEF3 chr6_138160939_138161938 0.1628000 0.17032602 0.16213668</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15024   450</code></pre>
</div>
</div>
<p>Correlation test</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>mat_tfpred <span class="ot">&lt;-</span> tfpred_matrix <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">all_of</span>(<span class="fu">c</span>(<span class="st">'symbol'</span>, geuvadis_individuals))) <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">'symbol'</span>)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>mat_expr <span class="ot">&lt;-</span> gene_expr <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">all_of</span>(<span class="fu">c</span>(<span class="st">'symbol'</span>, geuvadis_individuals))) <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">'symbol'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># match and order the rownames and colnames</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>mat_expr <span class="ot">&lt;-</span> mat_expr[<span class="fu">order</span>(<span class="fu">match</span>(<span class="fu">rownames</span>(mat_expr), <span class="fu">rownames</span>(mat_tfpred))), ]</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>mat_expr <span class="ot">&lt;-</span> mat_expr[, <span class="fu">order</span>(<span class="fu">match</span>(<span class="fu">colnames</span>(mat_expr), <span class="fu">colnames</span>(mat_tfpred)))]</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(<span class="fu">rownames</span>(mat_expr), <span class="fu">rownames</span>(mat_tfpred))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(<span class="fu">colnames</span>(mat_expr), <span class="fu">colnames</span>(mat_tfpred))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>mat_expr[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>] ; mat_tfpred[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          HG00262    HG00246    HG00187    HG00151    NA12872
PDSS2   5.3915374 6.43179821 5.05124412 5.77283326 6.66565395
PSMG4   9.5442514 8.46678114 9.22689323 5.93059666 8.76995406
CDC5L   7.9962083 7.36412146 7.51830398 7.64343824 8.82999947
BRPF3   2.2469991 1.59482969 3.60196774 3.01528350 3.26838748
ARFGEF3 0.0209032 0.03468664 0.03468043 0.02786052 0.01132483</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>          HG00262    HG00246    HG00187    HG00151    NA12872
PDSS2   0.3306418 0.33286358 0.32760535 0.32684507 0.33357008
PSMG4   0.2122660 0.21198024 0.21221499 0.21438659 0.21107506
CDC5L   0.0210355 0.02070309 0.01877992 0.01806819 0.01854296
BRPF3   0.2970409 0.29687855 0.29652629 0.29620033 0.29660880
ARFGEF3 0.1628000 0.17032602 0.16213668 0.16485335 0.16580068</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>pvec <span class="ot">=</span> <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="fu">nrow</span>(mat_expr))</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>cvec <span class="ot">=</span> <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="fu">nrow</span>(mat_expr))</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(cc <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mat_expr)) {</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> mat_tfpred[cc, ] <span class="sc">|&gt;</span> <span class="fu">unlist</span>() <span class="sc">|&gt;</span> <span class="fu">unname</span>()</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> mat_expr[cc, ] <span class="sc">|&gt;</span> <span class="fu">unlist</span>() <span class="sc">|&gt;</span> <span class="fu">unname</span>()</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tryCatch</span>({</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>        res <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(y, x, <span class="at">method=</span><span class="st">'spearman'</span>)</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>        pvec[cc] <span class="ot">=</span> res<span class="sc">$</span>p.value</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>        cvec[cc] <span class="ot">=</span> res<span class="sc">$</span>estimate</span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>    }, <span class="at">error=</span><span class="cf">function</span>(a){</span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>        pvec[cc] <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>        cvec[cc] <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">#res =  #t.test(pred[cc, obs[cc,]==1], pred[cc,obs[cc, ]==0])</span></span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pvec) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(mat_expr)</span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(cvec) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(mat_expr)</span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-21"><a href="#cb91-21" aria-hidden="true" tabindex="-1"></a><span class="co"># there may be some NAs ==&gt; what are the indices</span></span>
<span id="cb91-22"><a href="#cb91-22" aria-hidden="true" tabindex="-1"></a>na_ids <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">is.na</span>(cvec))</span>
<span id="cb91-23"><a href="#cb91-23" aria-hidden="true" tabindex="-1"></a>na_ids</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(<span class="fu">abs</span>(cvec) <span class="sc">&gt;</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qq_generic</span>(pvec, <span class="at">distribution=</span><span class="st">'uniform'</span>, <span class="at">neg_log10_values=</span>T, <span class="at">BH=</span>T, <span class="at">params_to_legend=</span><span class="fu">list</span>(<span class="at">x=</span><span class="st">'topleft'</span>, <span class="at">bty =</span> <span class="st">"n"</span>), <span class="at">params_to_plot=</span><span class="fu">list</span>(<span class="at">frame.plot=</span>F, <span class="at">pch=</span><span class="dv">19</span>))</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="fu">expression</span>(<span class="st">"qqplot of"</span> <span class="sc">~</span> <span class="fu">italic</span>(p) <span class="sc">~</span> <span class="st">"(correlation test)"</span>), <span class="at">side=</span><span class="dv">3</span>, <span class="at">line=</span><span class="dv">2</span>, <span class="at">adj=</span><span class="fl">0.05</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="fu">glue</span>(<span class="st">"Correlation of TFPred scores with gene expression for GEUVADIS individuals"</span>), <span class="at">side=</span><span class="dv">3</span>, <span class="at">line=</span><span class="dv">0</span>, <span class="at">cex=</span><span class="fl">1.2</span>, <span class="at">adj=</span><span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(cvec, <span class="at">main=</span><span class="st">''</span>, <span class="at">xlab=</span><span class="fu">expression</span>(<span class="fu">italic</span>(rho)<span class="sc">*</span><span class="st">', correlation coefficient'</span>), <span class="at">cex.lab=</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">'brown'</span>)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="fu">expression</span>(<span class="st">"Distribution of"</span> <span class="sc">~</span> rho <span class="sc">~</span> <span class="st">"(correlation coefficient)"</span>), <span class="at">side=</span><span class="dv">3</span>, <span class="at">line=</span><span class="dv">2</span>, <span class="at">adj=</span><span class="fl">0.05</span>, <span class="at">cex=</span><span class="fl">1.2</span>) </span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="fu">glue</span>(<span class="st">"TFPred scores with gene expression for GEUVADIS individuals"</span>), <span class="at">side=</span><span class="dv">3</span>, <span class="at">line=</span><span class="dv">0</span>, <span class="at">cex=</span><span class="fl">1.2</span>, <span class="at">adj=</span><span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(pvec, <span class="at">main=</span><span class="st">''</span>, <span class="at">xlab=</span><span class="fu">expression</span>(<span class="fu">italic</span>(p)<span class="sc">*</span><span class="st">"-value"</span>), <span class="at">cex.lab=</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">'brown'</span>)</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="fu">expression</span>(<span class="st">"Distribution of"</span> <span class="sc">~</span> p<span class="sc">*</span><span class="st">"-values for correlation test"</span>), <span class="at">side=</span><span class="dv">3</span>, <span class="at">line=</span><span class="dv">2</span>, <span class="at">adj=</span><span class="fl">0.05</span>, <span class="at">cex=</span><span class="fl">1.2</span>) </span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="fu">glue</span>(<span class="st">"TFPred scores with gene expression for GEUVADIS individuals"</span>), <span class="at">side=</span><span class="dv">3</span>, <span class="at">line=</span><span class="dv">0</span>, <span class="at">cex=</span><span class="fl">1.2</span>, <span class="at">adj=</span><span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Some plots</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>tt <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">abs</span>(cvec) <span class="sc">&gt;</span> <span class="fl">0.5</span>)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>aa <span class="ot">&lt;-</span> mat_expr[tt, ] <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">'locus'</span>)</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>bb <span class="ot">&lt;-</span> mat_tfpred[tt, ] <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">'locus'</span>)</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>merge_list <span class="ot">&lt;-</span> <span class="fu">list</span>(aa, bb)</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>top_cor <span class="ot">&lt;-</span> merge_list <span class="sc">%&gt;%</span> purrr<span class="sc">::</span><span class="fu">map</span>(., <span class="cf">function</span>(each_b){</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>  each_b <span class="sc">%&gt;%</span> tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="sc">!</span>locus)</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>}) <span class="sc">%&gt;%</span> purrr<span class="sc">::</span><span class="fu">reduce</span>(dplyr<span class="sc">::</span>inner_join, <span class="at">by=</span><span class="fu">c</span>(<span class="st">'locus'</span>, <span class="st">'name'</span>))</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(top_cor) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'locus'</span>, <span class="st">'name'</span>, <span class="st">'expr'</span>, <span class="st">'tfpred_score'</span>)</span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>top_cor[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>top_cor <span class="sc">%&gt;%</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">locus =</span> <span class="fu">as.factor</span>(locus)) <span class="sc">%&gt;%</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(.) <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x=</span>tfpred_score, <span class="at">y=</span>expr, <span class="at">group=</span>locus) <span class="sc">+</span> </span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">col=</span><span class="st">'red'</span>) <span class="sc">+</span> </span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>locus, <span class="at">scales=</span><span class="st">'free'</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="fu">glue</span>(<span class="st">'scatterplot of top {length(unique(top_cor$locus))} loci (ranked by p-values and highest absolute correlations)'</span>), <span class="at">x=</span><span class="st">'TFPred scores'</span>, <span class="at">x =</span> <span class="st">'gene expression (RPKM)'</span>) <span class="sc">+</span></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>), <span class="at">axis.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>best_cwas <span class="ot">&lt;-</span> cwas_scores_mat[top12<span class="sc">$</span>loci, ] <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">'loci'</span>)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>best_tfpred <span class="ot">&lt;-</span> tfpred_mat[top12<span class="sc">$</span>loci, ] <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">'loci'</span>)</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>best_gt <span class="ot">&lt;-</span> gt_matrix[top12<span class="sc">$</span>loci, ] <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">'loci'</span>)</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>merge_list <span class="ot">&lt;-</span> <span class="fu">list</span>(best_cwas, best_tfpred, best_gt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="cis-and-trans-associations" class="level2">
<h2 class="anchored" data-anchor-id="cis-and-trans-associations">Cis and trans associations</h2>
<section id="trans-effects" class="level3">
<h3 class="anchored" data-anchor-id="trans-effects">Trans effects</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># merge each loci </span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>mt <span class="ot">&lt;-</span> gene_expr <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">all_of</span>(<span class="fu">c</span>(<span class="st">'loci'</span>, <span class="st">'symbol'</span>)))</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>tfpred_matrix_2 <span class="ot">&lt;-</span> mat_tfpred <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">'symbol'</span>) <span class="sc">%&gt;%</span> <span class="fu">inner_join</span>(mt, <span class="at">by=</span><span class="fu">c</span>(<span class="st">'symbol'</span> <span class="ot">=</span> <span class="st">'symbol'</span>)) <span class="sc">%&gt;%</span> tidyr<span class="sc">::</span><span class="fu">separate_wider_delim</span>(loci, <span class="at">delim=</span><span class="st">'_'</span>, <span class="at">names=</span><span class="fu">c</span>(<span class="st">'chr'</span>, <span class="st">'start'</span>, <span class="st">'end'</span>)) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(start, end)) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">relocate</span>(chr)</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>tfpred_matrix_2[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 5
  chr   symbol  HG00262 HG00246 HG00187
  &lt;chr&gt; &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1 chr6  PDSS2    0.331   0.333   0.328 
2 chr6  PSMG4    0.212   0.212   0.212 
3 chr6  CDC5L    0.0210  0.0207  0.0188
4 chr6  BRPF3    0.297   0.297   0.297 
5 chr6  ARFGEF3  0.163   0.170   0.162 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>chr_order <span class="ot">&lt;-</span> tfpred_matrix_2<span class="sc">$</span>chr</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>mat_tfpred_2 <span class="ot">&lt;-</span> tfpred_matrix_2 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(chr)) <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">'symbol'</span>) <span class="sc">%&gt;%</span> <span class="fu">t</span>()</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>mat_tfpred_2[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            PDSS2     PSMG4      CDC5L     BRPF3   ARFGEF3
HG00262 0.3306418 0.2122660 0.02103550 0.2970409 0.1628000
HG00246 0.3328636 0.2119802 0.02070309 0.2968786 0.1703260
HG00187 0.3276054 0.2122150 0.01877992 0.2965263 0.1621367
HG00151 0.3268451 0.2143866 0.01806819 0.2962003 0.1648534
NA12872 0.3335701 0.2110751 0.01854296 0.2966088 0.1658007</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>mat_expr_2 <span class="ot">&lt;-</span> mat_expr <span class="sc">%&gt;%</span> <span class="fu">t</span>()</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>mat_expr_2[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           PDSS2    PSMG4    CDC5L    BRPF3    ARFGEF3
HG00262 5.391537 9.544251 7.996208 2.246999 0.02090320
HG00246 6.431798 8.466781 7.364121 1.594830 0.03468664
HG00187 5.051244 9.226893 7.518304 3.601968 0.03468043
HG00151 5.772833 5.930597 7.643438 3.015283 0.02786052
NA12872 6.665654 8.769954 8.829999 3.268387 0.01132483</code></pre>
</div>
</div>
<p>Remove NAs</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>expr_nas <span class="ot">&lt;-</span> <span class="fu">apply</span>(mat_expr_2, <span class="dv">2</span>, var) <span class="sc">!=</span> <span class="dv">0</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>tfpred_nas <span class="ot">&lt;-</span> <span class="fu">apply</span>(mat_tfpred_2, <span class="dv">2</span>, var) <span class="sc">!=</span> <span class="dv">0</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>both_true <span class="ot">&lt;-</span> (expr_nas <span class="sc">&amp;</span> tfpred_nas)</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>mat_expr_2 <span class="ot">&lt;-</span> mat_expr_2[, both_true]</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>mat_tfpred_2 <span class="ot">&lt;-</span> mat_tfpred_2[, both_true]</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>chr_order <span class="ot">&lt;-</span> chr_order[both_true] </span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(mat_expr_2) ; <span class="fu">dim</span>(mat_tfpred_2) ; <span class="fu">length</span>(chr_order)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]   448 15021</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]   448 15021</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15021</code></pre>
</div>
</div>
<p>For now, I am testing trans effects of promoters in chr1 against genes in other chromosomes</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>chr1 <span class="ot">&lt;-</span> <span class="fu">which</span>(chr_order <span class="sc">==</span> <span class="st">'chr1'</span>)</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>non_chr1 <span class="ot">&lt;-</span> <span class="fu">which</span>(chr_order <span class="sc">!=</span> <span class="st">'chr1'</span>)</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(chr1) ; <span class="fu">length</span>(non_chr1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1659</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 13362</code></pre>
</div>
</div>
<p>But I want to use the ranked values</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>mat_tfpred_ranked <span class="ot">&lt;-</span> <span class="fu">apply</span>(mat_tfpred_2, <span class="dv">2</span>, rank)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>mat_expr_ranked <span class="ot">&lt;-</span> <span class="fu">apply</span>(mat_expr_2, <span class="dv">2</span>, rank)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Checking</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mat_tfpred_ranked[, <span class="dv">1</span>], mat_tfpred_2[, <span class="dv">1</span>], <span class="at">xlab=</span><span class="st">'ranked tfpred score'</span>, <span class="at">ylab=</span><span class="st">'tfpred score'</span>, <span class="at">frame.plot=</span>F, <span class="at">main=</span><span class="st">'TFPred score vs ranked TFPred score for an arbitrary promoter region'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="association_2_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Some helper functions</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># with help from Haky</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>cor2pval <span class="ot">&lt;-</span> <span class="cf">function</span>(cc,nn) {</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>  zz <span class="ot">=</span> <span class="fu">atanh</span>(cc) <span class="sc">*</span> <span class="fu">sqrt</span>(nn<span class="dv">-3</span>)</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pnorm</span>(<span class="sc">-</span><span class="fu">abs</span>(zz))<span class="sc">*</span><span class="dv">2</span></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="cis-effect" class="level3">
<h3 class="anchored" data-anchor-id="cis-effect">cis effect</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>nterms <span class="ot">&lt;-</span> <span class="fu">nrow</span>(mat_tfpred_ranked)</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>nterms</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 448</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>cis_cor <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">scale</span>(mat_tfpred_ranked) <span class="sc">*</span> <span class="fu">scale</span>(mat_expr_ranked), <span class="dv">2</span>, sum)<span class="sc">/</span>nterms</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>cis_pvalues <span class="ot">&lt;-</span> <span class="fu">cor2pval</span>(cis_cor, nterms)</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>cis_cor[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>] ; cis_pvalues[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       PDSS2        PSMG4        CDC5L        BRPF3      ARFGEF3 
 0.074960904 -0.043727327 -0.005552571 -0.062128657 -0.015756209 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>    PDSS2     PSMG4     CDC5L     BRPF3   ARFGEF3 
0.1131314 0.3559980 0.9067548 0.1894204 0.7395834 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(cis_cor) ; <span class="fu">range</span>(cis_pvalues)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.6710080  0.6105636</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7.302809e-66 9.999372e-01</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which.max</span>(cis_cor) ; <span class="fu">which.min</span>(cis_cor) ; <span class="fu">which.min</span>(cis_pvalues)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SNHG5 
 1551 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>FLVCR1-DT 
     6356 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>FLVCR1-DT 
     6356 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qq_generic</span>(cis_pvalues, <span class="at">distribution=</span><span class="st">'uniform'</span>, <span class="at">neg_log10_values=</span>T, <span class="at">BH=</span>T, <span class="at">params_to_legend=</span><span class="fu">list</span>(<span class="at">x=</span><span class="st">'topleft'</span>, <span class="at">bty =</span> <span class="st">"n"</span>), <span class="at">params_to_plot=</span><span class="fu">list</span>(<span class="at">frame.plot=</span>F, <span class="at">pch=</span><span class="dv">19</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in qq_generic(cis_pvalues, distribution = "uniform", neg_log10_values =
T, : thresholding p to 1e-30</code></pre>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="fu">expression</span>(<span class="st">"qqplot of"</span> <span class="sc">~</span> <span class="fu">italic</span>(p) <span class="sc">~</span> <span class="st">"(correlation test)"</span>), <span class="at">side=</span><span class="dv">3</span>, <span class="at">line=</span><span class="dv">2</span>, <span class="at">adj=</span><span class="fl">0.05</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="fu">glue</span>(<span class="st">"Correlation of TFPred scores with gene expression for </span><span class="sc">\n</span><span class="st">GEUVADIS individuals"</span>), <span class="at">side=</span><span class="dv">3</span>, <span class="at">line=</span><span class="dv">0</span>, <span class="at">cex=</span><span class="fl">1.2</span>, <span class="at">adj=</span><span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="association_2_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(cis_pvalues, <span class="at">main=</span><span class="st">''</span>, <span class="at">xlab=</span><span class="fu">expression</span>(<span class="fu">italic</span>(p)<span class="sc">*</span><span class="st">"-value"</span>), <span class="at">cex.lab=</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">'brown'</span>)</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="fu">expression</span>(<span class="st">"Distribution of"</span> <span class="sc">~</span> p<span class="sc">*</span><span class="st">"-values for correlation test"</span>), <span class="at">side=</span><span class="dv">3</span>, <span class="at">line=</span><span class="dv">2</span>, <span class="at">adj=</span><span class="fl">0.05</span>, <span class="at">cex=</span><span class="fl">1.2</span>) </span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="fu">glue</span>(<span class="st">"TFPred scores with gene expression for </span><span class="sc">\n</span><span class="st">GEUVADIS individuals"</span>), <span class="at">side=</span><span class="dv">3</span>, <span class="at">line=</span><span class="dv">0</span>, <span class="at">cex=</span><span class="fl">1.2</span>, <span class="at">adj=</span><span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="association_2_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(cis_cor, <span class="at">main=</span><span class="st">''</span>, <span class="at">xlab=</span><span class="fu">expression</span>(<span class="fu">italic</span>(rho)<span class="sc">*</span><span class="st">', correlation coefficient'</span>), <span class="at">cex.lab=</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">'brown'</span>)</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="fu">expression</span>(<span class="st">"Distribution of"</span> <span class="sc">~</span> rho <span class="sc">~</span> <span class="st">"(correlation coefficient)"</span>), <span class="at">side=</span><span class="dv">3</span>, <span class="at">line=</span><span class="dv">2</span>, <span class="at">adj=</span><span class="fl">0.05</span>, <span class="at">cex=</span><span class="fl">1.2</span>) </span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="fu">glue</span>(<span class="st">"TFPred scores with gene expression for </span><span class="sc">\n</span><span class="st">GEUVADIS individuals"</span>), <span class="at">side=</span><span class="dv">3</span>, <span class="at">line=</span><span class="dv">0</span>, <span class="at">cex=</span><span class="fl">1.2</span>, <span class="at">adj=</span><span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="association_2_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="trans-effects-1" class="level3">
<h3 class="anchored" data-anchor-id="trans-effects-1">Trans effects</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>aa <span class="ot">&lt;-</span> <span class="fu">scale</span>(mat_tfpred_ranked[, chr1]) <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">scale</span>(mat_expr_ranked[, non_chr1])</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(aa) ; <span class="fu">dim</span>(bb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1659  448</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]   448 13362</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>trans_cor <span class="ot">&lt;-</span> (aa <span class="sc">%*%</span> bb)<span class="sc">/</span>nterms</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>trans_cor[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>] ; <span class="fu">range</span>(trans_cor[<span class="sc">!</span><span class="fu">is.na</span>(trans_cor)]) ; <span class="fu">dim</span>(trans_cor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               PDSS2        PSMG4       CDC5L        BRPF3     ARFGEF3
FAM72D   0.094374943  0.021409033  0.01532639  0.026247472 -0.05689126
VCAM1    0.014656161 -0.001585022 -0.01539521 -0.023944979 -0.02432502
NBPF4    0.009593758 -0.054146287 -0.02230203  0.092930524  0.11620463
ADAM15  -0.064118490 -0.019774092  0.01633493 -0.003247944  0.06813438
SUMO1P3  0.042506102 -0.013443725 -0.02497125  0.023956564 -0.05660072</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.3405610  0.3887832</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  1659 13362</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>trans_pvalues <span class="ot">&lt;-</span> <span class="fu">cor2pval</span>(trans_cor, nterms)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>trans_pvalues[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>] ; <span class="fu">range</span>(trans_pvalues[<span class="sc">!</span><span class="fu">is.na</span>(trans_pvalues)]) ; <span class="fu">dim</span>(trans_pvalues)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             PDSS2     PSMG4     CDC5L     BRPF3    ARFGEF3
FAM72D  0.04584866 0.6514901 0.7464409 0.5797032 0.22958846
VCAM1   0.75717381 0.9733268 0.7453416 0.6134068 0.60778475
NBPF4   0.83961438 0.2528994 0.6379693 0.0492935 0.01379862
ADAM15  0.17559630 0.6765399 0.7303828 0.9453751 0.15000139
SUMO1P3 0.36960803 0.7767071 0.5982778 0.6132351 0.23198116</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.857291e-18 1.000000e+00</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  1659 13362</code></pre>
</div>
</div>
</section>
<section id="plotting" class="level3">
<h3 class="anchored" data-anchor-id="plotting">plotting</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>neg_cis <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log10</span>(cis_pvalues)</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>neg_trans <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log10</span>(trans_pvalues)</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(neg_cis, neg_trans, <span class="at">frame.plot=</span>F)</span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a><span class="co">#abline(lm(sort(neg_trans) ~ sort(neg_cis)), col = "red", lwd = 2, lty = 2)</span></span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="fu">glue</span>(<span class="st">"trans effect AR binding at the promoters of </span><span class="sc">\n</span><span class="st">chr1 genes on non-chr1 genes"</span>), <span class="at">side=</span><span class="dv">3</span>, <span class="at">line=</span><span class="dv">0</span>, <span class="at">cex=</span><span class="fl">1.2</span>, <span class="at">adj=</span><span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="association_2_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="subsequent-analysis" class="level3">
<h3 class="anchored" data-anchor-id="subsequent-analysis">subsequent analysis</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>cis_pvalues[<span class="sc">!</span><span class="fu">is.na</span>(cis_pvalues)][<span class="fu">which.min</span>(cis_pvalues[<span class="sc">!</span><span class="fu">is.na</span>(cis_pvalues)])]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   FLVCR1-DT 
7.302809e-66 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>trans_pvalues[, <span class="st">'MAP3K2-DT'</span>][<span class="sc">!</span><span class="fu">is.na</span>(trans_pvalues[, <span class="st">'MAP3K2-DT'</span>])][<span class="fu">which.min</span>(trans_pvalues[, <span class="st">'MAP3K2-DT'</span>][<span class="sc">!</span><span class="fu">is.na</span>(trans_pvalues[, <span class="st">'MAP3K2-DT'</span>])])]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  PABPC4-AS1 
0.0004201727 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>trans_pvalues[<span class="fu">which</span>(trans_pvalues <span class="sc">&lt;</span> <span class="fl">1e-50</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>numeric(0)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>target_genes <span class="ot">&lt;-</span> <span class="fu">apply</span>(trans_pvalues, <span class="dv">2</span>, min) <span class="sc">%&gt;%</span> <span class="fu">sort</span>() <span class="sc">%&gt;%</span> <span class="fu">head</span>() <span class="co"># gene expression</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>trans_acting <span class="ot">&lt;-</span> <span class="fu">apply</span>(trans_pvalues, <span class="dv">1</span>, min) <span class="sc">%&gt;%</span> <span class="fu">sort</span>() <span class="sc">%&gt;%</span> <span class="fu">head</span>() <span class="co"># tfpred scores</span></span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>target_genes ; trans_acting</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     GSTM2P1    LINC02446       GAREM1        FRAS1        KCNJ2      FAM135B 
4.857291e-18 7.265973e-14 1.650982e-13 3.299641e-12 5.037444e-12 7.441861e-12 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>       GSTM1         ICMT        AP4B1    MATN1-AS1        ZMYM1       INPP5B 
4.857291e-18 7.265973e-14 1.650982e-13 1.796480e-13 6.441738e-13 1.115825e-12 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(trans_pvalues <span class="sc">==</span> <span class="fu">min</span>(trans_pvalues), <span class="at">arr.ind=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       row  col
GSTM1 1339 2507</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>target_genes ; trans_acting</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     GSTM2P1    LINC02446       GAREM1        FRAS1        KCNJ2      FAM135B 
4.857291e-18 7.265973e-14 1.650982e-13 3.299641e-12 5.037444e-12 7.441861e-12 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>       GSTM1         ICMT        AP4B1    MATN1-AS1        ZMYM1       INPP5B 
4.857291e-18 7.265973e-14 1.650982e-13 1.796480e-13 6.441738e-13 1.115825e-12 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> mat_expr[<span class="st">'GSTM2P1'</span>, ] <span class="sc">|&gt;</span> <span class="fu">as.vector</span>() <span class="sc">|&gt;</span> <span class="fu">unlist</span>()</span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> mat_tfpred[<span class="st">'GSTM1'</span>, ] <span class="sc">|&gt;</span> <span class="fu">as.vector</span>() <span class="sc">|&gt;</span> <span class="fu">unlist</span>()</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">xlab=</span><span class="st">'expression (GSTM2P1)'</span>, <span class="at">ylab=</span><span class="st">'TFPred score (GSTM1)'</span>, <span class="at">frame.plot=</span>F)</span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x), <span class="at">col=</span><span class="st">'red'</span>)</span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="fu">expression</span>(<span class="st">"TFPred score at the promoter of GSTM1 vs. </span><span class="sc">\n</span><span class="st">expression of GSTM2P1"</span>), <span class="at">side=</span><span class="dv">3</span>, <span class="at">line=</span><span class="dv">1</span>, <span class="at">adj=</span><span class="fl">0.05</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="association_2_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> mat_expr_ranked[, <span class="st">'GSTM2P1'</span>] <span class="sc">|&gt;</span> <span class="fu">as.vector</span>() <span class="sc">|&gt;</span> <span class="fu">unlist</span>()</span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> mat_tfpred_ranked[, <span class="st">'GSTM1'</span>] <span class="sc">|&gt;</span> <span class="fu">as.vector</span>() <span class="sc">|&gt;</span> <span class="fu">unlist</span>()</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">xlab=</span><span class="st">'expression (GSTM2P1)'</span>, <span class="at">ylab=</span><span class="st">'TFPred score (GSTM1)'</span>, <span class="at">frame.plot=</span>F)</span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x), <span class="at">col=</span><span class="st">'red'</span>)</span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="fu">expression</span>(<span class="st">"TFPred score at the promoter of GSTM1 vs. </span><span class="sc">\n</span><span class="st">expression of GSTM2P1 (ranked)"</span>), <span class="at">side=</span><span class="dv">3</span>, <span class="at">line=</span><span class="dv">1</span>, <span class="at">adj=</span><span class="fl">0.05</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="association_2_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> mat_expr[<span class="st">'FAM135B'</span>, ] <span class="sc">|&gt;</span> <span class="fu">as.vector</span>() <span class="sc">|&gt;</span> <span class="fu">unlist</span>()</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> mat_tfpred[<span class="st">'INPP5B'</span>, ] <span class="sc">|&gt;</span> <span class="fu">as.vector</span>() <span class="sc">|&gt;</span> <span class="fu">unlist</span>()</span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">xlab=</span><span class="st">'expression (FAM135B)'</span>, <span class="at">ylab=</span><span class="st">'TFPred score (INPP5B)'</span>, <span class="at">frame.plot=</span>F)</span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x), <span class="at">col=</span><span class="st">'red'</span>)</span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="fu">expression</span>(<span class="st">"TFPred score at promoter of INPP5B vs. </span><span class="sc">\n</span><span class="st">expression of FAM135B"</span>), <span class="at">side=</span><span class="dv">3</span>, <span class="at">line=</span><span class="dv">1</span>, <span class="at">adj=</span><span class="fl">0.05</span>, <span class="at">cex=</span><span class="fl">1.2</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="association_2_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> mat_expr_ranked[, <span class="st">'FAM135B'</span>] <span class="sc">|&gt;</span> <span class="fu">as.vector</span>() <span class="sc">|&gt;</span> <span class="fu">unlist</span>()</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> mat_tfpred_ranked[, <span class="st">'INPP5B'</span>] <span class="sc">|&gt;</span> <span class="fu">as.vector</span>() <span class="sc">|&gt;</span> <span class="fu">unlist</span>()</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">xlab=</span><span class="st">'expression (FAM135B)'</span>, <span class="at">ylab=</span><span class="st">'TFPred score (INPP5B)'</span>, <span class="at">frame.plot=</span>F)</span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x), <span class="at">col=</span><span class="st">'red'</span>)</span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="fu">expression</span>(<span class="st">"TFPred score at promoter of INPP5B vs. </span><span class="sc">\n</span><span class="st">expression of FAM135B (ranked)"</span>), <span class="at">side=</span><span class="dv">3</span>, <span class="at">line=</span><span class="dv">1</span>, <span class="at">adj=</span><span class="fl">0.05</span>, <span class="at">cex=</span><span class="fl">1.2</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="association_2_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>